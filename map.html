<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ìˆ˜ì§ˆì¸¡ì •ë§ ì§€ë„ Â· Safe Mode</title>
<link rel="icon" href="./assets/gongdan-mark.png" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<style>
  :root{
    --hdr:56px; --gap:12px;
    --sa-t:env(safe-area-inset-top,0px);
    --sa-r:env(safe-area-inset-right,0px);
    --sa-b:env(safe-area-inset-bottom,0px);
    --sa-l:env(safe-area-inset-left,0px);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:system-ui,Apple SD Gothic Neo,Pretendard,Segoe UI,Roboto,Arial}
  body{background:#0b1622;color:#e6eef6}
  .appbar{
    position:sticky;top:0;z-index:10;height:var(--hdr);
    padding:0 calc(var(--gap)+var(--sa-r)) 0 calc(var(--gap)+var(--sa-l));
    display:flex;align-items:center;gap:10px;background:#101b2a;border-bottom:1px solid rgba(255,255,255,.08)
  }
  .title{font-weight:800;letter-spacing:-.02em}
  .wrap{position:relative;height:calc(100dvh - var(--hdr));min-height:420px}
  #map{width:100%;height:100%}

  /* ì¢Œìƒë‹¨ íŒ¨ë„ */
  .panel{
    position:absolute;z-index:1100;
    left:calc(var(--gap)+var(--sa-l)); top:calc(var(--gap)+var(--sa-t));
    background:rgba(16,27,42,.96);color:#e6eef6;border:1px solid rgba(255,255,255,.1);
    border-radius:14px;padding:8px 10px;display:flex;align-items:center;gap:8px
  }
  .panel button{
    width:36px;height:36px;border:none;border-radius:10px;background:transparent;color:#e6eef6;display:grid;place-items:center;cursor:pointer
  }

  /* ìš°ìƒë‹¨ ì¤Œ ë²„íŠ¼ */
  .leaflet-top.leaflet-right{
    top:calc(var(--gap)+var(--sa-t));
    right:calc(var(--gap)+var(--sa-r));
  }
  /* ìš°í•˜ë‹¨ ë ˆì´ì–´(ì§€ê¸ˆì€ ìˆ¨ê¹€) ìœ„ì¹˜ ì˜ˆì•½ */
  .leaflet-bottom.leaflet-right{
    right:calc(var(--gap)+var(--sa-r));
    bottom:calc(88px + var(--sa-b));
  }

  /* GPS ë²„íŠ¼ ìš°í•˜ë‹¨ */
  .gps{
    position:absolute;z-index:1200;
    right:calc(var(--gap)+var(--sa-r));
    bottom:calc(20px + var(--sa-b));
    width:54px;height:54px;border:none;border-radius:999px;background:#00b894;color:#fff;font-size:24px;display:grid;place-items:center;box-shadow:0 6px 14px rgba(0,0,0,.35);cursor:pointer
  }

  /* í† ìŠ¤íŠ¸(ì•„ì´ì½˜ ìœ„) */
  .toast{
    position:absolute;z-index:1200;
    right:calc(var(--gap)+var(--sa-r)); bottom:calc(90px + var(--sa-b));
    background:rgba(0,0,0,.88);color:#fff;border-radius:10px;padding:10px 12px;font-size:14px;opacity:0;pointer-events:none;transition:opacity .2s
  }
  .toast.show{opacity:1}

  /* ì—ëŸ¬ ì˜¤ë²„ë ˆì´ */
  .err{
    position:fixed;inset:calc(8px + var(--sa-t)) calc(8px + var(--sa-r)) auto calc(8px + var(--sa-l));
    z-index:2000;background:#2b1d1d;color:#ffd7d7;border:1px solid #ff6b6b;border-radius:10px;padding:8px 10px;font-size:12px
  }
</style>
</head>
<body>
<header class="appbar"><div class="title">ìˆ˜ì§ˆì¸¡ì •ë§ ì§€ë„</div></header>

<main class="wrap">
  <!-- ì¢Œìƒë‹¨ ì„ì‹œ íŒ¨ë„(ë™ì‘ë§Œ í™•ì¸) -->
  <div class="panel" id="panel">
    <button aria-label="í•„í„°">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="2" stroke-linecap="round" d="M4 6h10M18 6h2M10 6v12M4 12h6M18 12h2M6 12v6M4 18h14M20 18h0M14 18v-8"/></svg>
    </button>
    <span style="font-size:13px;color:#9fb6cd">ì•„ì´ì½˜ ì„¸ì´í”„ì¡´ í™•ì¸ìš©</span>
  </div>

  <div id="map" role="region" aria-label="ì§€ë„"></div>

  <button class="gps" id="gpsBtn" aria-label="ë‚´ ìœ„ì¹˜">ğŸ“</button>
  <div class="toast" id="toast">ì•Œë¦¼</div>
</main>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  // í˜ì´ì§€ ì „ì—­ ì—ëŸ¬ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ê¸°(í•˜ì–—ê²Œ ë³´ì´ëŠ” ìƒí™© ë””ë²„ê·¸)
  window.addEventListener('error', e=>{
    const box=document.createElement('div'); box.className='err';
    box.textContent='JS Error: ' + (e.message||e.error||'unknown');
    document.body.appendChild(box);
  });

  // 1) ì§€ë„ë§Œ ë¨¼ì €
  const map = L.map('map', { zoomControl:false, preferCanvas:true });
  L.control.zoom({position:'topright'}).addTo(map);
  const base = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'Â© OSM'}).addTo(map);
  map.setView([37.5665,126.9780], 12);

  // 2) ì•„ì´ì½˜ ì•ˆì „ ìœ„ì¹˜ ë™ì‘ í™•ì¸(í† ìŠ¤íŠ¸/ë²„íŠ¼)
  const toast = (m)=>{ const t=document.getElementById('toast'); t.textContent=m; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1400); };
  document.getElementById('gpsBtn').addEventListener('click', ()=>{
    toast('ğŸ“¡ ë°ëª¨: GPS ë²„íŠ¼ í´ë¦­ë¨');
  });

  // 3) ë¦¬ì‚¬ì´ì¦ˆ ì‹œ í¬ê¸° ë³´ì •(ëª¨ë°”ì¼ ì£¼ì†Œì°½ ë³€í™” ëŒ€ì‘)
  addEventListener('resize', ()=> map.invalidateSize(
